{"dependencies":[{"name":"react","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":1,"column":0,"index":0},"end":{"line":1,"column":89,"index":89}}],"key":"RtGiGa+/H7VrI7GDQDLhO1UbpU8=","exportNames":["*"],"imports":1}},{"name":"@react-native-async-storage/async-storage","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":2,"column":0,"index":90},"end":{"line":2,"column":69,"index":159}}],"key":"0kSRlooyBOaYM9tlTtK91nq+uds=","exportNames":["*"],"imports":1}},{"name":"react-native-web/dist/exports/Alert","data":{"asyncType":null,"isESMImport":false,"locs":[],"key":"PEUC6jrQVoAGZ2qYkvimljMOyJI=","exportNames":["*"],"imports":1}},{"name":"../services/api","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":4,"column":0,"index":198},"end":{"line":4,"column":38,"index":236}}],"key":"Pr5/EB33W7mJGi+ygccy+pUf1E8=","exportNames":["*"],"imports":1}},{"name":"react/jsx-dev-runtime","data":{"asyncType":null,"isESMImport":false,"locs":[],"key":"L9D70Z4hi4aGuui1ysja/oQ5ytI=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  var _jsxFileName = \"/app/frontend/src/context/AuthContext.tsx\";\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  function _interopDefault(e) {\n    return e && e.__esModule ? e : {\n      default: e\n    };\n  }\n  exports.AuthProvider = AuthProvider;\n  exports.useAuth = useAuth;\n  var _react = require(_dependencyMap[0], \"react\");\n  var _reactNativeAsyncStorageAsyncStorage = require(_dependencyMap[1], \"@react-native-async-storage/async-storage\");\n  var AsyncStorage = _interopDefault(_reactNativeAsyncStorageAsyncStorage);\n  var _reactNativeWebDistExportsAlert = require(_dependencyMap[2], \"react-native-web/dist/exports/Alert\");\n  var Alert = _interopDefault(_reactNativeWebDistExportsAlert);\n  var _servicesApi = require(_dependencyMap[3], \"../services/api\");\n  var _reactJsxDevRuntime = require(_dependencyMap[4], \"react/jsx-dev-runtime\");\n  const AuthContext = /*#__PURE__*/(0, _react.createContext)(undefined);\n  function AuthProvider({\n    children\n  }) {\n    const [user, setUser] = (0, _react.useState)(null);\n    const [isLoading, setIsLoading] = (0, _react.useState)(true);\n    const checkAuth = async () => {\n      try {\n        setIsLoading(true);\n        const token = await AsyncStorage.default.getItem('session_token');\n        if (token) {\n          const response = await _servicesApi.api.get('/auth/me', {\n            headers: {\n              Authorization: `Bearer ${token}`\n            }\n          });\n          setUser(response.data);\n        }\n      } catch (error) {\n        console.log('Auth check failed:', error);\n        await AsyncStorage.default.removeItem('session_token');\n        setUser(null);\n      } finally {\n        setIsLoading(false);\n      }\n    };\n    const login = async (email, password) => {\n      try {\n        setIsLoading(true);\n        // For now, we use Google OAuth, so this is a placeholder\n        return false;\n      } catch (error) {\n        console.error('Login error:', error);\n        return false;\n      } finally {\n        setIsLoading(false);\n      }\n    };\n    const processSessionId = async sessionId => {\n      try {\n        setIsLoading(true);\n        const response = await _servicesApi.api.post('/auth/session', {\n          session_id: sessionId\n        });\n        const {\n          user: userData,\n          session_token\n        } = response.data;\n        await AsyncStorage.default.setItem('session_token', session_token);\n        setUser(userData);\n        return true;\n      } catch (error) {\n        console.error('Process session error:', error);\n\n        // Handle specific error cases\n        if (error.response?.status === 403) {\n          const message = error.response?.data?.detail || 'Your account is not registered as an active tenant. Please contact the dormitory administrator.';\n          Alert.default.alert('Access Denied', message);\n        } else if (error.response?.status === 401) {\n          Alert.default.alert('Authentication Failed', 'Invalid session. Please try logging in again.');\n        } else {\n          Alert.default.alert('Error', 'Unable to sign in. Please try again later.');\n        }\n        return false;\n      } finally {\n        setIsLoading(false);\n      }\n    };\n    const logout = async () => {\n      try {\n        const token = await AsyncStorage.default.getItem('session_token');\n        if (token) {\n          await _servicesApi.api.post('/auth/logout', {}, {\n            headers: {\n              Authorization: `Bearer ${token}`\n            }\n          });\n        }\n      } catch (error) {\n        console.error('Logout error:', error);\n      } finally {\n        await AsyncStorage.default.removeItem('session_token');\n        setUser(null);\n      }\n    };\n    const updateUser = data => {\n      if (user) {\n        setUser({\n          ...user,\n          ...data\n        });\n      }\n    };\n    return /*#__PURE__*/(0, _reactJsxDevRuntime.jsxDEV)(AuthContext.Provider, {\n      value: {\n        user,\n        isLoading,\n        login,\n        logout,\n        checkAuth,\n        processSessionId,\n        updateUser\n      },\n      children: children\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 115,\n      columnNumber: 5\n    }, this);\n  }\n  function useAuth() {\n    const context = (0, _react.useContext)(AuthContext);\n    if (context === undefined) {\n      throw new Error('useAuth must be used within an AuthProvider');\n    }\n    return context;\n  }\n});","lineCount":139,"map":[[13,2,28,0,"exports"],[13,9,28,0],[13,10,28,0,"AuthProvider"],[13,22,28,0],[13,25,28,0,"AuthProvider"],[13,37,28,0],[14,2,131,0,"exports"],[14,9,131,0],[14,10,131,0,"useAuth"],[14,17,131,0],[14,20,131,0,"useAuth"],[14,27,131,0],[15,2,1,0],[15,6,1,0,"_react"],[15,12,1,0],[15,15,1,0,"require"],[15,22,1,0],[15,23,1,0,"_dependencyMap"],[15,37,1,0],[16,2,2,0],[16,6,2,0,"_reactNativeAsyncStorageAsyncStorage"],[16,42,2,0],[16,45,2,0,"require"],[16,52,2,0],[16,53,2,0,"_dependencyMap"],[16,67,2,0],[17,2,2,0],[17,6,2,0,"AsyncStorage"],[17,18,2,0],[17,21,2,0,"_interopDefault"],[17,36,2,0],[17,37,2,0,"_reactNativeAsyncStorageAsyncStorage"],[17,73,2,0],[18,2,2,69],[18,6,2,69,"_reactNativeWebDistExportsAlert"],[18,37,2,69],[18,40,2,69,"require"],[18,47,2,69],[18,48,2,69,"_dependencyMap"],[18,62,2,69],[19,2,2,69],[19,6,2,69,"Alert"],[19,11,2,69],[19,14,2,69,"_interopDefault"],[19,29,2,69],[19,30,2,69,"_reactNativeWebDistExportsAlert"],[19,61,2,69],[20,2,4,0],[20,6,4,0,"_servicesApi"],[20,18,4,0],[20,21,4,0,"require"],[20,28,4,0],[20,29,4,0,"_dependencyMap"],[20,43,4,0],[21,2,4,38],[21,6,4,38,"_reactJsxDevRuntime"],[21,25,4,38],[21,28,4,38,"require"],[21,35,4,38],[21,36,4,38,"_dependencyMap"],[21,50,4,38],[22,2,26,0],[22,8,26,6,"AuthContext"],[22,19,26,17],[22,35,26,20],[22,39,26,20,"createContext"],[22,45,26,33],[22,46,26,33,"createContext"],[22,59,26,33],[22,61,26,63,"undefined"],[22,70,26,72],[22,71,26,73],[23,2,28,7],[23,11,28,16,"AuthProvider"],[23,23,28,28,"AuthProvider"],[23,24,28,29],[24,4,28,31,"children"],[25,2,28,65],[25,3,28,66],[25,5,28,68],[26,4,29,2],[26,10,29,8],[26,11,29,9,"user"],[26,15,29,13],[26,17,29,15,"setUser"],[26,24,29,22],[26,25,29,23],[26,28,29,26],[26,32,29,26,"useState"],[26,38,29,34],[26,39,29,34,"useState"],[26,47,29,34],[26,49,29,48],[26,53,29,52],[26,54,29,53],[27,4,30,2],[27,10,30,8],[27,11,30,9,"isLoading"],[27,20,30,18],[27,22,30,20,"setIsLoading"],[27,34,30,32],[27,35,30,33],[27,38,30,36],[27,42,30,36,"useState"],[27,48,30,44],[27,49,30,44,"useState"],[27,57,30,44],[27,59,30,45],[27,63,30,49],[27,64,30,50],[28,4,32,2],[28,10,32,8,"checkAuth"],[28,19,32,17],[28,22,32,20],[28,28,32,20,"checkAuth"],[28,29,32,20],[28,34,32,32],[29,6,33,4],[29,10,33,8],[30,8,34,6,"setIsLoading"],[30,20,34,18],[30,21,34,19],[30,25,34,23],[30,26,34,24],[31,8,35,6],[31,14,35,12,"token"],[31,19,35,17],[31,22,35,20],[31,28,35,26,"AsyncStorage"],[31,40,35,38],[31,41,35,38,"default"],[31,48,35,38],[31,49,35,39,"getItem"],[31,56,35,46],[31,57,35,47],[31,72,35,62],[31,73,35,63],[32,8,36,6],[32,12,36,10,"token"],[32,17,36,15],[32,19,36,17],[33,10,37,8],[33,16,37,14,"response"],[33,24,37,22],[33,27,37,25],[33,33,37,31,"api"],[33,45,37,34],[33,46,37,34,"api"],[33,49,37,34],[33,50,37,35,"get"],[33,53,37,38],[33,54,37,39],[33,64,37,49],[33,66,37,51],[34,12,38,10,"headers"],[34,19,38,17],[34,21,38,19],[35,14,38,21,"Authorization"],[35,27,38,34],[35,29,38,36],[35,39,38,46,"token"],[35,44,38,51],[36,12,38,54],[37,10,39,8],[37,11,39,9],[37,12,39,10],[38,10,40,8,"setUser"],[38,17,40,15],[38,18,40,16,"response"],[38,26,40,24],[38,27,40,25,"data"],[38,31,40,29],[38,32,40,30],[39,8,41,6],[40,6,42,4],[40,7,42,5],[40,8,42,6],[40,15,42,13,"error"],[40,20,42,18],[40,22,42,20],[41,8,43,6,"console"],[41,15,43,13],[41,16,43,14,"log"],[41,19,43,17],[41,20,43,18],[41,40,43,38],[41,42,43,40,"error"],[41,47,43,45],[41,48,43,46],[42,8,44,6],[42,14,44,12,"AsyncStorage"],[42,26,44,24],[42,27,44,24,"default"],[42,34,44,24],[42,35,44,25,"removeItem"],[42,45,44,35],[42,46,44,36],[42,61,44,51],[42,62,44,52],[43,8,45,6,"setUser"],[43,15,45,13],[43,16,45,14],[43,20,45,18],[43,21,45,19],[44,6,46,4],[44,7,46,5],[44,16,46,14],[45,8,47,6,"setIsLoading"],[45,20,47,18],[45,21,47,19],[45,26,47,24],[45,27,47,25],[46,6,48,4],[47,4,49,2],[47,5,49,3],[48,4,51,2],[48,10,51,8,"login"],[48,15,51,13],[48,18,51,16],[48,24,51,16,"login"],[48,25,51,23,"email"],[48,30,51,36],[48,32,51,38,"password"],[48,40,51,54],[48,45,51,77],[49,6,52,4],[49,10,52,8],[50,8,53,6,"setIsLoading"],[50,20,53,18],[50,21,53,19],[50,25,53,23],[50,26,53,24],[51,8,54,6],[52,8,55,6],[52,15,55,13],[52,20,55,18],[53,6,56,4],[53,7,56,5],[53,8,56,6],[53,15,56,13,"error"],[53,20,56,18],[53,22,56,20],[54,8,57,6,"console"],[54,15,57,13],[54,16,57,14,"error"],[54,21,57,19],[54,22,57,20],[54,36,57,34],[54,38,57,36,"error"],[54,43,57,41],[54,44,57,42],[55,8,58,6],[55,15,58,13],[55,20,58,18],[56,6,59,4],[56,7,59,5],[56,16,59,14],[57,8,60,6,"setIsLoading"],[57,20,60,18],[57,21,60,19],[57,26,60,24],[57,27,60,25],[58,6,61,4],[59,4,62,2],[59,5,62,3],[60,4,64,2],[60,10,64,8,"processSessionId"],[60,26,64,24],[60,29,64,27],[60,35,64,34,"sessionId"],[60,44,64,51],[60,48,64,74],[61,6,65,4],[61,10,65,8],[62,8,66,6,"setIsLoading"],[62,20,66,18],[62,21,66,19],[62,25,66,23],[62,26,66,24],[63,8,67,6],[63,14,67,12,"response"],[63,22,67,20],[63,25,67,23],[63,31,67,29,"api"],[63,43,67,32],[63,44,67,32,"api"],[63,47,67,32],[63,48,67,33,"post"],[63,52,67,37],[63,53,67,38],[63,68,67,53],[63,70,67,55],[64,10,67,57,"session_id"],[64,20,67,67],[64,22,67,69,"sessionId"],[65,8,67,79],[65,9,67,80],[65,10,67,81],[66,8,68,6],[66,14,68,12],[67,10,68,14,"user"],[67,14,68,18],[67,16,68,20,"userData"],[67,24,68,28],[68,10,68,30,"session_token"],[69,8,68,44],[69,9,68,45],[69,12,68,48,"response"],[69,20,68,56],[69,21,68,57,"data"],[69,25,68,61],[70,8,70,6],[70,14,70,12,"AsyncStorage"],[70,26,70,24],[70,27,70,24,"default"],[70,34,70,24],[70,35,70,25,"setItem"],[70,42,70,32],[70,43,70,33],[70,58,70,48],[70,60,70,50,"session_token"],[70,73,70,63],[70,74,70,64],[71,8,71,6,"setUser"],[71,15,71,13],[71,16,71,14,"userData"],[71,24,71,22],[71,25,71,23],[72,8,72,6],[72,15,72,13],[72,19,72,17],[73,6,73,4],[73,7,73,5],[73,8,73,6],[73,15,73,13,"error"],[73,20,73,23],[73,22,73,25],[74,8,74,6,"console"],[74,15,74,13],[74,16,74,14,"error"],[74,21,74,19],[74,22,74,20],[74,46,74,44],[74,48,74,46,"error"],[74,53,74,51],[74,54,74,52],[76,8,76,6],[77,8,77,6],[77,12,77,10,"error"],[77,17,77,15],[77,18,77,16,"response"],[77,26,77,24],[77,28,77,26,"status"],[77,34,77,32],[77,39,77,37],[77,42,77,40],[77,44,77,42],[78,10,78,8],[78,16,78,14,"message"],[78,23,78,21],[78,26,78,24,"error"],[78,31,78,29],[78,32,78,30,"response"],[78,40,78,38],[78,42,78,40,"data"],[78,46,78,44],[78,48,78,46,"detail"],[78,54,78,52],[78,58,79,10],[78,155,79,107],[79,10,80,8,"Alert"],[79,15,80,13],[79,16,80,13,"default"],[79,23,80,13],[79,24,80,14,"alert"],[79,29,80,19],[79,30,80,20],[79,45,80,35],[79,47,80,37,"message"],[79,54,80,44],[79,55,80,45],[80,8,81,6],[80,9,81,7],[80,15,81,13],[80,19,81,17,"error"],[80,24,81,22],[80,25,81,23,"response"],[80,33,81,31],[80,35,81,33,"status"],[80,41,81,39],[80,46,81,44],[80,49,81,47],[80,51,81,49],[81,10,82,8,"Alert"],[81,15,82,13],[81,16,82,13,"default"],[81,23,82,13],[81,24,82,14,"alert"],[81,29,82,19],[81,30,82,20],[81,53,82,43],[81,55,82,45],[81,102,82,92],[81,103,82,93],[82,8,83,6],[82,9,83,7],[82,15,83,13],[83,10,84,8,"Alert"],[83,15,84,13],[83,16,84,13,"default"],[83,23,84,13],[83,24,84,14,"alert"],[83,29,84,19],[83,30,84,20],[83,37,84,27],[83,39,84,29],[83,83,84,73],[83,84,84,74],[84,8,85,6],[85,8,86,6],[85,15,86,13],[85,20,86,18],[86,6,87,4],[86,7,87,5],[86,16,87,14],[87,8,88,6,"setIsLoading"],[87,20,88,18],[87,21,88,19],[87,26,88,24],[87,27,88,25],[88,6,89,4],[89,4,90,2],[89,5,90,3],[90,4,92,2],[90,10,92,8,"logout"],[90,16,92,14],[90,19,92,17],[90,25,92,17,"logout"],[90,26,92,17],[90,31,92,29],[91,6,93,4],[91,10,93,8],[92,8,94,6],[92,14,94,12,"token"],[92,19,94,17],[92,22,94,20],[92,28,94,26,"AsyncStorage"],[92,40,94,38],[92,41,94,38,"default"],[92,48,94,38],[92,49,94,39,"getItem"],[92,56,94,46],[92,57,94,47],[92,72,94,62],[92,73,94,63],[93,8,95,6],[93,12,95,10,"token"],[93,17,95,15],[93,19,95,17],[94,10,96,8],[94,16,96,14,"api"],[94,28,96,17],[94,29,96,17,"api"],[94,32,96,17],[94,33,96,18,"post"],[94,37,96,22],[94,38,96,23],[94,52,96,37],[94,54,96,39],[94,55,96,40],[94,56,96,41],[94,58,96,43],[95,12,97,10,"headers"],[95,19,97,17],[95,21,97,19],[96,14,97,21,"Authorization"],[96,27,97,34],[96,29,97,36],[96,39,97,46,"token"],[96,44,97,51],[97,12,97,54],[98,10,98,8],[98,11,98,9],[98,12,98,10],[99,8,99,6],[100,6,100,4],[100,7,100,5],[100,8,100,6],[100,15,100,13,"error"],[100,20,100,18],[100,22,100,20],[101,8,101,6,"console"],[101,15,101,13],[101,16,101,14,"error"],[101,21,101,19],[101,22,101,20],[101,37,101,35],[101,39,101,37,"error"],[101,44,101,42],[101,45,101,43],[102,6,102,4],[102,7,102,5],[102,16,102,14],[103,8,103,6],[103,14,103,12,"AsyncStorage"],[103,26,103,24],[103,27,103,24,"default"],[103,34,103,24],[103,35,103,25,"removeItem"],[103,45,103,35],[103,46,103,36],[103,61,103,51],[103,62,103,52],[104,8,104,6,"setUser"],[104,15,104,13],[104,16,104,14],[104,20,104,18],[104,21,104,19],[105,6,105,4],[106,4,106,2],[106,5,106,3],[107,4,108,2],[107,10,108,8,"updateUser"],[107,20,108,18],[107,23,108,22,"data"],[107,27,108,41],[107,31,108,46],[108,6,109,4],[108,10,109,8,"user"],[108,14,109,12],[108,16,109,14],[109,8,110,6,"setUser"],[109,15,110,13],[109,16,110,14],[110,10,110,16],[110,13,110,19,"user"],[110,17,110,23],[111,10,110,25],[111,13,110,28,"data"],[112,8,110,33],[112,9,110,34],[112,10,110,35],[113,6,111,4],[114,4,112,2],[114,5,112,3],[115,4,114,2],[115,24,115,4],[115,28,115,4,"_reactJsxDevRuntime"],[115,47,115,4],[115,48,115,4,"jsxDEV"],[115,54,115,4],[115,56,115,5,"AuthContext"],[115,67,115,16],[115,68,115,17,"Provider"],[115,76,115,25],[116,6,116,6,"value"],[116,11,116,11],[116,13,116,13],[117,8,117,8,"user"],[117,12,117,12],[118,8,118,8,"isLoading"],[118,17,118,17],[119,8,119,8,"login"],[119,13,119,13],[120,8,120,8,"logout"],[120,14,120,14],[121,8,121,8,"checkAuth"],[121,17,121,17],[122,8,122,8,"processSessionId"],[122,24,122,24],[123,8,123,8,"updateUser"],[124,6,124,6],[124,7,124,8],[125,6,124,8,"children"],[125,14,124,8],[125,16,126,7,"children"],[126,4,126,15],[127,6,126,15,"fileName"],[127,14,126,15],[127,16,126,15,"_jsxFileName"],[127,28,126,15],[128,6,126,15,"lineNumber"],[128,16,126,15],[129,6,126,15,"columnNumber"],[129,18,126,15],[130,4,126,15],[130,11,127,26],[130,12,127,27],[131,2,129,0],[132,2,131,7],[132,11,131,16,"useAuth"],[132,18,131,23,"useAuth"],[132,19,131,23],[132,21,131,26],[133,4,132,2],[133,10,132,8,"context"],[133,17,132,15],[133,20,132,18],[133,24,132,18,"useContext"],[133,30,132,28],[133,31,132,28,"useContext"],[133,41,132,28],[133,43,132,29,"AuthContext"],[133,54,132,40],[133,55,132,41],[134,4,133,2],[134,8,133,6,"context"],[134,15,133,13],[134,20,133,18,"undefined"],[134,29,133,27],[134,31,133,29],[135,6,134,4],[135,12,134,10],[135,16,134,14,"Error"],[135,21,134,19],[135,22,134,20],[135,67,134,65],[135,68,134,66],[136,4,135,2],[137,4,136,2],[137,11,136,9,"context"],[137,18,136,16],[138,2,137,0],[139,0,137,1],[139,3]],"functionMap":{"names":["<global>","AuthProvider","checkAuth","login","processSessionId","logout","updateUser","useAuth"],"mappings":"AAA;OC2B;oBCI;GDiB;gBEE;GFW;2BGE;GH0B;iBIE;GJc;qBKE;GLI;CDiB;OOE;CPM"},"hasCjsExports":false},"type":"js/module"}]}